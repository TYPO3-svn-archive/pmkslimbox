var Mediabox;(function(){var N=0,s,h,E,y,D,k,q,n,r=new Image(),L=new Image(),I,b,j,F,c,K,w,B,J,M,e,v,G,x,p,t,l,i="none",f,d="mediaBox",u;window.addEvent("domready",function(){$(document.body).adopt($$([I=new Element("div",{id:"mbOverlay"}).addEvent("click",C),b=new Element("div",{id:"mbCenter"}),F=new Element("div",{id:"mbBottomContainer"})]).setStyle("display","none"));j=new Element("div",{id:"mbImage"}).injectInside(b);c=new Element("div",{id:"mbBottom"}).injectInside(F).adopt(new Element("a",{id:"mbCloseLink",href:"#"}).addEvent("click",C),e=new Element("a",{id:"mbNextLink",href:"#"}).addEvent("click",g),J=new Element("a",{id:"mbPrevLink",href:"#"}).addEvent("click",z),w=new Element("div",{id:"mbTitle"}),M=new Element("div",{id:"mbNumber"}),B=new Element("div",{id:"mbCaption"}),new Element("div",{styles:{clear:"both"}}));q={overlay:new Fx.Tween(I,{property:"opacity",duration:360}).set(0),image:new Fx.Tween(j,{property:"opacity",duration:360,onComplete:H}),bottom:new Fx.Tween(c,{property:"margin-top",duration:240})}});Mediabox={close:function(){C()},open:function(Q,P,O){s=$extend({loop:false,stopKey:true,overlayOpacity:0.7,resizeDuration:240,resizeTransition:false,initialWidth:360,initialHeight:240,showCaption:true,animateCaption:true,showCounter:true,counterText:"  ({x} of {y})",scriptaccess:"true",fullscreen:"true",fullscreenNum:"1",autoplay:"true",autoplayNum:"1",autoplayYes:"yes",bgcolor:"#000000",playerpath:"../js/player.swf",backcolor:"000000",frontcolor:"999999",lightcolor:"000000",screencolor:"000000",controlbar:"over",useNB:true,NBpath:"../js/NonverBlaster.swf",NBloop:"true",controllerColor:"0x777777",showTimecode:"false",controller:"true",flInfo:"true",revverID:"187866",revverFullscreen:"true",revverBack:"000000",revverFront:"ffffff",revverGrad:"000000",ytColor1:"000000",ytColor2:"333333",ytQuality:"&ap=%2526fmt%3D18",vdPlayer:"false",vmTitle:"1",vmByline:"1",vmPortrait:"1",vmColor:"ffffff"},O||{});if(typeof Q=="string"){Q=[[Q,P,O]];P=0}if((Browser.Engine.gecko)&&(Browser.Engine.version<19)){s.overlayOpacity=1;I.className="mbOverlayFF"}h=Q;s.loop=s.loop&&(h.length>1);A();m(true);k=window.getScrollTop()+(window.getHeight()/15);q.resize=new Fx.Morph(b,$extend({duration:s.resizeDuration,onComplete:H},s.resizeTransition?{transition:s.resizeTransition}:{}));b.setStyles({top:k,width:s.initialWidth,height:s.initialHeight,marginLeft:-(s.initialWidth/2),display:""});q.overlay.start(s.overlayOpacity);N=1;return a(P)}};Element.implement({mediabox:function(O,P){$$(this).mediabox(O,P);return this}});Elements.implement({mediabox:function(O,R,Q){R=R||function(S){p=S.rel.split(/[\[\]]/);p=p[1];return[S.href,S.title,p]};Q=Q||function(){return true};var P=this;P.removeEvents("click").addEvent("click",function(){var T=P.filter(Q,this);var U=[];var S=[];T.each(function(W,V){if(S.indexOf(W.toString())<0){U.include(T[V]);S.include(T[V].toString())}});return Mediabox.open(U.map(R),S.indexOf(this.toString()),O)});return P}});function A(){I.setStyles({top:window.getScrollTop(),height:window.getHeight()})}function m(O){["object",window.ie?"select":"embed"].forEach(function(Q){Array.forEach(document.getElementsByTagName(Q),function(R){if(O){R._mediabox=R.style.visibility}R.style.visibility=O?"hidden":R._mediabox})});I.style.display=O?"":"none";var P=O?"addEvent":"removeEvent";window[P]("scroll",A)[P]("resize",A);document[P]("keydown",o)}function o(O){switch(O.code){case 27:case 88:case 67:C();break;case 37:case 80:z();break;case 39:case 78:g()}if(s.stopKey){return false}}function z(){return a(y)}function g(){return a(D)}function a(O){if((N==1)&&(O>=0)){N=2;j.set("html","");E=O;y=((E||!s.loop)?E:h.length)-1;D=E+1;if(D==h.length){D=s.loop?0:-1}$$(J,e,j,F).setStyle("display","none");q.bottom.cancel().set(0);q.image.set(0);b.className="mbLoading";G=h[O][2].split(" ");x=G.length;if(x>1){t=(G[x-2].match("%"))?(window.getWidth()*("0."+(G[x-2].replace("%",""))))+"px":G[x-2]+"px";l=(G[x-1].match("%"))?(window.getHeight()*("0."+(G[x-1].replace("%",""))))+"px":G[x-1]+"px"}else{t="";l=""}v=h[O][0];K=h[E][1].split("::");if(v.match(/quietube\.com/i)){f=v.split("v.php/");v=f[1]}if(v.match(/\.gif|\.jpg|\.png/i)){i="img";n=new Image();n.onload=H;n.src=h[O][0]}else{if(v.match(/\.flv|\.mp4/i)){i="obj";t=t||s.initialWidth;l=l||s.initialHeight;if(s.useNB){n=new Swiff(""+s.NBpath+"?videoURL="+v+"&allowSmoothing=true&autoPlay="+s.autoplay+"&buffer=6&showTimecode="+s.showTimecode+"&loop="+s.NBloop+"&controlColour="+s.controllerColor+"&scaleIfFullScreen=true&showScalingButton=false",{id:"MediaboxSWF",width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}})}else{n=new Swiff(""+s.playerpath+"?file="+v+"&backcolor="+s.backcolor+"&frontcolor="+s.frontcolor+"&lightcolor="+s.lightcolor+"&screencolor="+s.screencolor+"&autostart="+s.autoplay+"&controlbar="+s.controlbar,{id:"MediaboxSWF",width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}})}H()}else{if(v.match(/\.mp3|\.aac/i)){i="obj";t=t||s.initialWidth;l=l||s.initialHeight;n=new Swiff(""+s.playerpath+"?file="+v+"&backcolor="+s.backcolor+"&frontcolor="+s.frontcolor+"&lightcolor="+s.lightcolor+"&screencolor="+s.screencolor+"&autostart="+s.autoplay,{id:"MediaboxSWF",width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/\.swf/i)){i="obj";t=t||s.initialWidth;l=l||s.initialHeight;n=new Swiff(v,{id:"MediaboxSWF",width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/blip\.tv/i)){i="obj";t=t||"640px";l=l||"390px";n=new Swiff(v,{src:v,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/dailymotion\.com/i)){i="obj";t=t||"480px";l=l||"381px";n=new Swiff(v,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/facebook\.com/i)){i="obj";t=t||"320px";l=l||"240px";f=v.split("v=");f=f[1].split("&");d=f[0];n=new Swiff("http://www.facebook.com/v/"+d,{movie:"http://www.facebook.com/v/"+d,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});startEffect()}else{if(v.match(/flickr\.com/i)){i="obj";t=t||"500px";l=l||"375px";f=v.split("/");d=f[5];n=new Swiff("http://www.flickr.com/apps/video/stewart.swf",{id:d,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:t,height:l,params:{flashvars:"photo_id="+d+"&amp;show_info_box="+s.flInfo,wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/google\.com\/videoplay/i)){i="obj";t=t||"400px";l=l||"326px";f=v.split("=");d=f[1];n=new Swiff("http://video.google.com/googleplayer.swf?docId="+d+"&autoplay="+s.autoplayNum,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/megavideo\.com/i)){i="obj";t=t||"640px";l=l||"360px";f=v.split("=");d=f[1];n=new Swiff("http://wwwstatic.megavideo.com/mv_player.swf?v="+d,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/metacafe\.com\/watch/i)){i="obj";t=t||"400px";l=l||"345px";f=v.split("/");d=f[4];n=new Swiff("http://www.metacafe.com/fplayer/"+d+"/.swf?playerVars=autoPlay="+s.autoplayYes,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/myspacetv\.com|vids\.myspace\.com/i)){i="obj";t=t||"425px";l=l||"360px";f=v.split("=");d=f[2];n=new Swiff("http://lads.myspace.com/videos/vplayer.swf?m="+d+"&v=2&a="+s.autoplayNum+"&type=video",{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/revver\.com/i)){i="obj";t=t||"480px";l=l||"392px";f=v.split("/");d=f[4];n=new Swiff("http://flash.revver.com/player/1.0/player.swf?mediaId="+d+"&affiliateId="+s.revverID+"&allowFullScreen="+s.revverFullscreen+"&autoStart="+s.autoplay+"&backColor=#"+s.revverBack+"&frontColor=#"+s.revverFront+"&gradColor=#"+s.revverGrad+"&shareUrl=revver",{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/rutube\.ru/i)){i="obj";t=t||"470px";l=l||"353px";f=v.split("=");d=f[1];n=new Swiff("http://video.rutube.ru/"+d,{movie:"http://video.rutube.ru/"+d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/seesmic\.com/i)){i="obj";t=t||"435px";l=l||"355px";f=v.split("/");d=f[5];n=new Swiff("http://seesmic.com/Standalone.swf?video="+d,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/tudou\.com/i)){i="obj";t=t||"400px";l=l||"340px";f=v.split("/");d=f[5];n=new Swiff("http://www.tudou.com/v/"+d,{width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/youku\.com/i)){i="obj";t=t||"480px";l=l||"400px";f=v.split("id_");d=f[1];n=new Swiff("http://player.youku.com/player.php/sid/"+d+"=/v.swf",{width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/youtube\.com\/watch/i)){i="obj";f=v.split("v=");d=f[1];if(d.match(/fmt=18/i)){u="&ap=%2526fmt%3D18";t=t||"560px";l=l||"345px"}else{if(d.match(/fmt=22/i)){u="&ap=%2526fmt%3D22";t=t||"640px";l=l||"385px"}else{u=s.ytQuality;t=t||"480px";l=l||"295px"}}n=new Swiff("http://www.youtube.com/v/"+d+"&autoplay="+s.autoplayNum+"&fs="+s.fullscreenNum+u+"&color1=0x"+s.ytColor1+"&color2=0x"+s.ytColor2,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/youtube\.com\/view/i)){i="obj";f=v.split("p=");d=f[1];t=t||"480px";l=l||"385px";n=new Swiff("http://www.youtube.com/p/"+d+"&autoplay="+s.autoplayNum+"&fs="+s.fullscreenNum+u+"&color1=0x"+s.ytColor1+"&color2=0x"+s.ytColor2,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/veoh\.com/i)){i="obj";t=t||"410px";l=l||"341px";f=v.split("videos/");d=f[1];n=new Swiff("http://www.veoh.com/videodetails2.swf?permalinkId="+d+"&player=videodetailsembedded&videoAutoPlay="+s.AutoplayNum,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/viddler\.com/i)){i="obj";t=t||"437px";l=l||"370px";f=v.split("/");d=f[4];n=new Swiff(v,{id:"viddler_"+d,movie:v,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen,id:"viddler_"+d,movie:v}});H()}else{if(v.match(/vimeo\.com/i)){i="obj";t=t||"400px";l=l||"225px";f=v.split("/");d=f[3];n=new Swiff("http://www.vimeo.com/moogaloop.swf?clip_id="+d+"&amp;server=www.vimeo.com&amp;fullscreen="+s.fullscreenNum+"&amp;autoplay="+s.autoplayNum+"&amp;show_title="+s.vmTitle+"&amp;show_byline="+s.vmByline+"&amp;show_portrait="+s.vmPortrait+"&amp;color="+s.vmColor,{id:d,width:t,height:l,params:{wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/12seconds\.tv/i)){i="obj";t=t||"430px";l=l||"360px";f=v.split("/");d=f[5];n=new Swiff("http://embed.12seconds.tv/players/remotePlayer.swf",{id:d,width:t,height:l,params:{flashvars:"vid="+d+"",wmode:"opaque",bgcolor:s.bgcolor,allowscriptaccess:s.scriptaccess,allowfullscreen:s.fullscreen}});H()}else{if(v.match(/\#mb_/i)){i="inline";t=t||s.initialWidth;l=l||s.initialHeight;URLsplit=v.split("#");n=$(URLsplit[1]).get("html");H()}else{i="url";t=t||s.initialWidth;l=l||s.initialHeight;d="mediaId_"+new Date().getTime();n=new Element("iframe",{src:v,id:d,width:t,height:l,frameborder:0});H()}}}}}}}}}}}}}}}}}}}}}}}}}return false}function H(){switch(N++){case 2:if(i=="img"){t=n.width;l=n.height;j.setStyles({backgroundImage:"url("+v+")",display:""})}else{if(i=="obj"){if(Browser.Plugins.Flash.version<8){j.setStyles({backgroundImage:"none",display:""});j.set("html",'<div id="mbError"><b>Error</b><br/>Adobe Flash is either not installed or not up to date,<br/>please visit <a href="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" title="Get Flash" target="_new">Adobe.com</a> to download the free player.</div>')}else{j.setStyles({backgroundImage:"none",display:""});n.inject(j)}}else{if(i=="inline"){j.setStyles({backgroundImage:"none",display:""});j.set("html",n)}else{if(i=="url"){j.setStyles({backgroundImage:"none",display:""});n.inject(j)}else{alert("this file type is not supported\n"+v+"\nplease visit iaian7.com/webcode/Mediabox for more information")}}}}$$(j,c).setStyle("width",t);j.setStyle("height",l);w.set("html",(s.showCaption)?K[0]:"");B.set("html",(s.showCaption&&(K.length>1))?K[1]:"");M.set("html",(s.showCounter&&(h.length>1))?s.counterText.replace(/{x}/,E+1).replace(/{y}/,h.length):"");if((y>=0)&&(h[y][0].match(/\.gif|\.jpg|\.png/i))){r.src=h[y][0]}if((D>=0)&&(h[D][0].match(/\.gif|\.jpg|\.png/i))){L.src=h[D][0]}N++;case 3:b.className="";q.resize.start({height:j.offsetHeight,width:j.offsetWidth,marginLeft:-j.offsetWidth/2});break;N++;case 4:F.setStyles({top:k+b.clientHeight,marginLeft:b.style.marginLeft,visibility:"hidden",display:""});q.image.start(1);break;case 5:if(y>=0){J.style.display=""}if(D>=0){e.style.display=""}if(s.animateCaption){q.bottom.set(-c.offsetHeight).start(0)}F.style.visibility="";N=1}}function C(){if(N){N=0;n.onload=$empty;j.set("html","");for(var O in q){q[O].cancel()}$$(b,F).setStyle("display","none");q.overlay.chain(m).start(0)}return false}})();Mediabox.scanPage=function(){var a=$$("a").filter(function(b){return b.rel&&b.rel.test(/^lightbox/i)});$$(a).mediabox({},null,function(c){var b=this.rel.replace(/[[]|]/gi," ");var d=b.split(" ");return(this==c)||((this.rel.length>8)&&c.rel.match(d[1]))})};window.addEvent("domready",Mediabox.scanPage);